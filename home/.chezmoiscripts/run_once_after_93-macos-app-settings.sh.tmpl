{{- if (eq .chezmoi.os "darwin") -}}
#!/usr/bin/env bash
set -euo pipefail

THEME_NAME="Solarized Darcula"
THEMES_DIR="$HOME/.local/share/settings/macos-terminal-themes"
THEME_FILE="$THEMES_DIR/$THEME_NAME.terminal"
SETTINGS=$(dirname $(chezmoi source-path))/settings
echo $SETTINGS
echo "Resolved theme path: $SETTINGS/macos-terminal-themes/Solarized Darcula.terminal"

# Import the theme (safe to run multiple times)
open "$THEME_FILE"

# Give Terminal a moment to register the profile
sleep 1

# Set default and startup profiles
defaults write com.apple.Terminal "Default Window Settings" -string "$THEME_NAME"
defaults write com.apple.Terminal "Startup Window Settings" -string "$THEME_NAME"

# Ensure preferences are reloaded
killall Terminal 2>/dev/null || true
{{ end -}}
